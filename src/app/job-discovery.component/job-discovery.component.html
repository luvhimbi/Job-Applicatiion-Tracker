<app-navbar></app-navbar>

<div class="container py-5">
  <div class="text-center mb-5">
    <h1 class="fw-bold text-dark">Job Board Directory</h1>
    <p class="text-muted">Explore South African and Global career hubs.</p>
  </div>

  <div class="row justify-content-center mb-5">
    <div class="col-md-8">
      <div class="input-group input-group-lg shadow-sm rounded-pill overflow-hidden border">
        <span class="input-group-text bg-white border-0 ps-4"><i class="bi bi-search"></i></span>
        <input type="text"
               class="form-control border-0 ps-2 py-3"
               placeholder="Search by company name or industry..."
               (input)="onSearch($event)">
      </div>

      <div class="d-flex justify-content-center flex-wrap gap-2 mt-4">
        <button
          *ngFor="let cat of categories"
          (click)="setFilter(cat)"
          class="btn rounded-pill px-4 transition-all"
          [ngClass]="(selectedCategory$ | async) === cat ? 'btn-primary shadow-sm' : 'btn-light border text-muted'">
          {{ cat }}
        </button>
      </div>
    </div>
  </div>

  <div *ngIf="!(filteredSources$ | async)" class="text-center py-5">
    <div class="spinner-border text-primary" role="status"></div>
  </div>

  <div class="row g-4" *ngIf="filteredSources$ | async as sources">
    <div class="col-md-6 col-lg-4" *ngFor="let source of sources">
      <div class="card h-100 border-0 shadow-sm resource-card" (click)="openSource(source.url)">
        <div class="card-body p-4">
          <div class="d-flex align-items-center mb-3">
            <div class="icon-box rounded-3 me-3"
                 [style.backgroundColor]="source.color + '15'"
                 [style.color]="source.color">
              <i class="bi {{ source.icon }} fs-4"></i>
            </div>
            <div>
              <span class="badge rounded-pill bg-light text-dark border mb-1">{{ source.category }}</span>
              <h5 class="fw-bold mb-0">{{ source.name }}</h5>
            </div>
          </div>
          <p class="text-secondary small mb-4">{{ source.description }}</p>
          <div class="text-primary fw-semibold small">
            Explore Jobs <i class="bi bi-arrow-up-right ms-1"></i>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="sources.length === 0" class="text-center py-5 w-100">
      <i class="bi bi-emoji-frown fs-1 text-muted"></i>
      <p class="text-muted mt-2">No platforms found matching your criteria.</p>
    </div>
  </div>

  <nav class="mt-5" *ngIf="totalPages > 1">
    <ul class="pagination justify-content-center gap-2">

      <li class="page-item" [class.disabled]="(currentPage$ | async) === 1">
        <button class="page-link rounded-pill px-3 border-0 bg-light text-dark"
                (click)="prevPage()">
          <i class="bi bi-chevron-left"></i>
        </button>
      </li>

      <li class="page-item" *ngFor="let p of [].constructor(totalPages); let i = index">
        <button class="page-link rounded-pill px-3 border-0"
                [class.bg-primary]="(currentPage$ | async) === i + 1"
                [class.text-white]="(currentPage$ | async) === i + 1"
                [class.bg-light]="(currentPage$ | async) !== i + 1"
                [class.text-dark]="(currentPage$ | async) !== i + 1"
                (click)="setPage(i + 1)">
          {{ i + 1 }}
        </button>
      </li>

      <li class="page-item" [class.disabled]="(currentPage$ | async) === totalPages">
        <button class="page-link rounded-pill px-3 border-0 bg-light text-dark"
                (click)="nextPage()">
          <i class="bi bi-chevron-right"></i>
        </button>
      </li>

    </ul>
  </nav>
</div>
